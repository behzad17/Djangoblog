{% extends "base.html" %}
{% load static %}
{% block content %}
{% static 'images/default.jpg' as default_image_url %}
<!-- Hero Section -->
<section
  class="hero-section text-white mb-4 askme-hero-section"
  style="
    padding: 3rem 0;
  "
>
  <div class="container">
    <div class="row justify-content-center text-center">
      <div class="col-lg-8 askme-hero-column">
        <h1 class="hero-title mb-3">
          <i class="fas fa-question-circle ms-2"></i>سؤال از متخصص
        </h1>
        <p class="hero-subtitle">
          پاسخ‌هایی که از سوی متخصصان حاضر در  این صفحه ارائه می‌شوند، با دقت، مسئولیت‌پذیری بالا و بر پایه دانش و تجربه حرفه‌ای تنظیم شده‌اند و تلاش می‌شود برای شما ارزش تخصصی و کاربردی داشته باشند. با این حال، این پاسخ‌ها جنبه رسمی، حقوقی یا اداری الزام‌آور ندارند و نباید به‌عنوان جایگزین مشاوره رسمی نهادها یا مراجع قانونی تلقی شوند. هدف این بخش، کمک به درک بهتر موضوعات، روشن‌تر شدن مسیر تصمیم‌گیری و به‌اشتراک‌گذاری تجربه و دانش تخصصی است.
          با کلیک بر روی پروفایل هر متخصص سوال خود را مطرح و منتظر پاسخ در بخش "مشاهده سوالات من" باشید.
        </p>
        <div class="alert alert-warning mt-3 mb-0" role="alert" style="background-color: rgba(255, 193, 7, 0.9); border: 1px solid rgba(255, 193, 7, 1); color: #000 !important; font-weight: 500; border-radius: 10px; font-size: 110%;">
          <i class="fas fa-info-circle ms-2" style="color: #000 !important;"></i>
          <strong style="color: #000 !important;">توجه:</strong> <span style="color: #000 !important;">پروفایل هایی که نام متخصص در آن ذکر نشده فعلا فعال نیستند</span>
        </div>
        <div class="alert alert-warning mt-3 mb-0" role="alert" style="background-color: rgba(255, 193, 7, 0.9); border: 1px solid rgba(255, 193, 7, 1); color: #000 !important; font-weight: 500; border-radius: 10px; font-size: 110%;">
          <i class="fas fa-shield-alt ms-2" style="color: #000 !important;"></i>
          <span style="color: #000 !important;">به‌منظور محافظت از حریم خصوصی افراد طبق قانون، هیچ فردی دیگری جز شما و متخصص مربوطه به سؤال و پاسخ دسترسی ندارد!</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Moderators Grid -->
<div class="container mb-5">
  <div class="row">
    <div class="col-12">
      <h2 class="text-center mb-4">
        <i class="fas fa-users ms-2"></i>صفحه متخصصان
      </h2>
    </div>
  </div>

  {% if moderators %}
  <div class="row g-4 justify-content-center">
    {% for moderator in moderators %}
    <div class="col-lg-3 col-md-4 col-sm-6">
      <div class="moderator-card card h-100 shadow-sm">
        <div class="card-body text-center px-3 pt-3 pb-1">
          <div class="moderator-image-wrapper mb-2">
            <img
              src="{% if moderator.profile_image and moderator.profile_image.url %}{{ moderator.profile_image.url }}{% else %}{{ default_image_url }}{% endif %}"
              alt="{{ moderator.get_display_name }}"
              class="moderator-image"
              onerror="this.onerror=null; this.src='{{ default_image_url }}';"
            />
          </div>
          <h5 class="moderator-name mb-1">
            {% if moderator.slug %}
            <a href="{% url 'expert_profile' moderator.slug %}" class="text-decoration-none text-dark">
              {{ moderator.get_display_name }}
            </a>
            {% else %}
            {{ moderator.get_display_name }}
            {% endif %}
          </h5>
          <p class="moderator-title text-primary mb-2">
            <i class="fas fa-certificate ms-1"></i>{{ moderator.expert_title }}
          </p>
          {% if moderator.bio %}
          <p class="moderator-bio small text-muted mb-2">
            {{ moderator.bio|striptags|truncatewords:15 }}
          </p>
          {% endif %}
          <div class="moderator-stats mb-2">
            <small class="text-muted">
              <i class="fas fa-question-circle ms-1"></i>{{ moderator.question_count }} سوال پاسخ داده شده
            </small>
          </div>
          {% if user.is_authenticated %}
          {% if moderator.slug %}
          <a
            href="{% url 'expert_profile' moderator.slug %}"
            class="btn btn-primary btn-sm w-100 ask-question-btn"
          >
            <i class="fas fa-paper-plane ms-2"></i>پرسیدن سوال
          </a>
          {% else %}
          <button
            type="button"
            class="btn btn-primary btn-sm w-100 ask-question-btn"
            disabled
          >
            <i class="fas fa-paper-plane ms-2"></i>پرسیدن سوال
          </button>
          {% endif %}
          {% else %}
          <a
            href="{% url 'account_login' %}"
            class="btn btn-outline-primary btn-sm w-100"
          >
            <i class="fas fa-sign-in-alt ms-2"></i>ورود برای پرسیدن
          </a>
          {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="row">
    <div class="col-12 text-center">
      <p class="text-muted">
        در حال حاضر متخصصی در دسترس نیست. لطفاً بعداً بررسی کنید.
      </p>
    </div>
  </div>
  {% endif %}
  {% if user.is_authenticated %}
  <div class="row mt-5">
    <div class="col-12">
      <div class="askme-actions d-flex justify-content-center gap-3">
        <a
        href="{% url 'my_questions' %}"
        class="btn position-relative askme-action-btn askme-primary-btn"
      >
        <i class="fas fa-list-alt"></i>مشاهده سوالات من
        {% if answered_count > 0 %}
        <span
          class="position-absolute top-0 end-0 translate-middle badge rounded-pill bg-danger notification-badge"
        >
          {{ answered_count }}
          <span class="visually-hidden">سوالات پاسخ داده شده</span>
        </span>
        {% endif %}
      </a>
      {% if user.moderator_profile %}
      <a
        href="{% url 'moderator_dashboard' %}"
        class="btn askme-action-btn askme-secondary-btn"
      >
        <i class="fas fa-tachometer-alt"></i>پنل متخصص
      </a>
      {% endif %}
      </div>
    </div>
  </div>
  {% endif %}
</div>
{% endblock content %}
