{% extends "base.html" %}
{% load static %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section bg-dark text-white mb-4" style="background: linear-gradient(135deg, #1b1f24 0%, #0d6efd 100%); padding: 2rem 0;">
  <div class="container">
    <div class="row justify-content-center text-center">
      <div class="col-lg-8">
        <h1 class="hero-title mb-3">
          <i class="fas fa-tachometer-alt me-2"></i>Moderator Dashboard
        </h1>
        <p class="hero-subtitle">
          Welcome, {{ moderator.user.get_full_name|default:moderator.user.username }} - {{ moderator.expert_title }}
        </p>
      </div>
    </div>
  </div>
</section>

<div class="container mb-5">
  <!-- Statistics Cards -->
  <div class="row mb-4">
    <div class="col-md-4 mb-3">
      <div class="card text-center bg-primary text-white">
        <div class="card-body">
          <h3>{{ stats.total }}</h3>
          <p class="mb-0">Total Questions</p>
        </div>
      </div>
    </div>
    <div class="col-md-4 mb-3">
      <div class="card text-center bg-success text-white">
        <div class="card-body">
          <h3>{{ stats.answered }}</h3>
          <p class="mb-0">Answered</p>
        </div>
      </div>
    </div>
    <div class="col-md-4 mb-3">
      <div class="card text-center bg-warning text-dark">
        <div class="card-body">
          <h3>{{ stats.pending }}</h3>
          <p class="mb-0">Pending</p>
        </div>
      </div>
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-12">
      <a href="{% url 'ask_me' %}" class="btn btn-outline-primary">
        <i class="fas fa-arrow-left me-2"></i>Back to Ask Me
      </a>
    </div>
  </div>

  <!-- Pending Questions -->
  {% if pending_questions %}
  <div class="row mb-4">
    <div class="col-12">
      <h3 class="mb-3">
        <i class="fas fa-clock text-warning me-2"></i>Pending Questions
      </h3>
      {% for question in pending_questions %}
      <div class="card mb-3 shadow-sm">
        <div class="card-header bg-warning bg-opacity-10">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ question.user.username }}</strong>
              <span class="text-muted ms-2">({{ question.user.email }})</span>
            </div>
            <small class="text-muted">
              <i class="fas fa-calendar me-1"></i>{{ question.created_on|date:"F d, Y H:i" }}
            </small>
          </div>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <h6 class="text-muted mb-2">
              <i class="fas fa-question me-1"></i>Question:
            </h6>
            <p class="question-text">{{ question.question_text }}</p>
          </div>
          <form method="post" action="{% url 'answer_question' question.id %}" class="answer-form">
            {% csrf_token %}
            <div class="mb-3">
              <label for="answer_{{ question.id }}" class="form-label">
                <i class="fas fa-reply me-1"></i>Your Answer:
              </label>
              <textarea 
                name="answer_text" 
                id="answer_{{ question.id }}" 
                class="form-control" 
                rows="5" 
                placeholder="Provide your answer here..."
                required
              ></textarea>
            </div>
            <button type="submit" class="btn btn-success">
              <i class="fas fa-check me-2"></i>Submit Answer
            </button>
          </form>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  <!-- Answered Questions -->
  {% if answered_questions %}
  <div class="row">
    <div class="col-12">
      <h3 class="mb-3">
        <i class="fas fa-check-circle text-success me-2"></i>Answered Questions
      </h3>
      {% for question in answered_questions %}
      <div class="card mb-3 shadow-sm">
        <div class="card-header bg-success bg-opacity-10">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ question.user.username }}</strong>
              <span class="text-muted ms-2">({{ question.user.email }})</span>
            </div>
            <small class="text-muted">
              <i class="fas fa-calendar me-1"></i>Answered: {{ question.answered_on|date:"F d, Y H:i" }}
            </small>
          </div>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <h6 class="text-muted mb-2">
              <i class="fas fa-question me-1"></i>Question:
            </h6>
            <p class="question-text">{{ question.question_text }}</p>
          </div>
          <div class="answer-section p-3 bg-light rounded">
            <h6 class="text-primary mb-2">
              <i class="fas fa-reply me-1"></i>Your Answer:
            </h6>
            <p class="answer-text mb-0">{{ question.answer_text }}</p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  {% if not pending_questions and not answered_questions %}
  <div class="row">
    <div class="col-12 text-center py-5">
      <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
      <p class="text-muted">No questions assigned to you yet.</p>
    </div>
  </div>
  {% endif %}
</div>
{% endblock content %}

