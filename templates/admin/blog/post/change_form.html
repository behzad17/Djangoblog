{% extends "admin/change_form.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<!-- CRITICAL: Set jQuery aliases immediately - must run before ANY scripts -->
<script type="text/javascript">
// Immediately check for django.jQuery and set aliases
// This runs synchronously in the head, before any other scripts execute
(function() {
    'use strict';
    
    // Function to set aliases - called immediately and on interval
    function setAliases() {
        if (typeof django !== 'undefined' && typeof django.jQuery !== 'undefined' && django.jQuery) {
            // Set aliases - allow overwrite if needed
            try {
                window.$ = django.jQuery;
                window.jQuery = django.jQuery;
                return true;
            } catch(e) {
                console.warn('Could not set jQuery aliases:', e);
            }
        }
        return false;
    }
    
    // Try immediately
    setAliases();
    
    // Also poll aggressively in case django.jQuery loads after this script
    var attempts = 0;
    var maxAttempts = 500; // 5 seconds
    var pollInterval = setInterval(function() {
        if (setAliases() || attempts++ >= maxAttempts) {
            clearInterval(pollInterval);
        }
    }, 10);
})();
</script>
{% endblock %}

