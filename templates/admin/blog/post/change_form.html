{% extends "admin/change_form.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<!-- CRITICAL: Set jQuery aliases - must run before ANY scripts -->
<script type="text/javascript">
// Immediately set $ and jQuery aliases for django.jQuery
// This runs synchronously in head, before any other scripts
(function() {
    'use strict';
    
    function setAliases() {
        if (typeof django !== 'undefined' && typeof django.jQuery !== 'undefined' && django.jQuery) {
            try {
                window.$ = django.jQuery;
                window.jQuery = django.jQuery;
                return true;
            } catch(e) {
                // Ignore
            }
        }
        return false;
    }
    
    // Try immediately
    setAliases();
    
    // Poll aggressively
    var attempts = 0;
    var maxAttempts = 1000;
    var pollInterval = setInterval(function() {
        if (setAliases() || attempts++ >= maxAttempts) {
            clearInterval(pollInterval);
        }
    }, 10);
})();
</script>
{% endblock %}

