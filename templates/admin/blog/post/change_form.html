{% extends "admin/change_form.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<!-- CRITICAL: Set jQuery aliases IMMEDIATELY and SYNCHRONOUSLY -->
<!-- This MUST run before ANY scripts, including Summernote dependencies -->
<script type="text/javascript">
// Immediately define $ and jQuery as aliases for django.jQuery
// This runs synchronously in the head, before any other scripts execute
(function() {
    'use strict';
    
    // Function to set aliases - must be synchronous
    function setAliases() {
        if (typeof django !== 'undefined' && typeof django.jQuery !== 'undefined' && django.jQuery) {
            try {
                window.$ = django.jQuery;
                window.jQuery = django.jQuery;
                return true;
            } catch(e) {
                // Ignore errors
            }
        }
        return false;
    }
    
    // Try immediately (synchronous)
    setAliases();
    
    // Also poll aggressively in case django.jQuery loads after this script
    // But this script runs in head, so django.jQuery should be available
    var attempts = 0;
    var maxAttempts = 1000; // 10 seconds - very aggressive
    var pollInterval = setInterval(function() {
        if (setAliases() || attempts++ >= maxAttempts) {
            clearInterval(pollInterval);
        }
    }, 10);
})();
</script>
{% endblock %}

