{% extends "admin/change_form.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<!-- jQuery alias is handled by static/admin/js/jquery_alias_fix.js via Media class -->
<!-- This ensures it loads before Summernote scripts -->
{% endblock %}

{% block extrahead %}
{{ block.super }}
<!-- Ensure jQuery aliases are set and wait for Summernote initialization -->
<script type="text/javascript">
// Backup: Ensure jQuery aliases are set after page load
(function() {
    'use strict';
    
    function ensureJQueryAliases() {
        if (typeof django !== 'undefined' && typeof django.jQuery !== 'undefined' && django.jQuery) {
            if (typeof window.$ === 'undefined' || window.$ !== django.jQuery) {
                window.$ = django.jQuery;
            }
            if (typeof window.jQuery === 'undefined' || window.jQuery !== django.jQuery) {
                window.jQuery = django.jQuery;
            }
            return true;
        }
        return false;
    }
    
    // Try immediately
    ensureJQueryAliases();
    
    // Also try on DOM ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', ensureJQueryAliases);
    } else {
        ensureJQueryAliases();
    }
    
    // Poll as backup
    var attempts = 0;
    var maxAttempts = 100;
    var pollInterval = setInterval(function() {
        if (ensureJQueryAliases() || attempts++ >= maxAttempts) {
            clearInterval(pollInterval);
        }
    }, 50);
})();
</script>
{% endblock %}

