{% load static %}
{% load category_extras %}
{% comment %}
  Reusable 3D Category Carousel Partial
  
  Usage:
    {% include 'includes/category_carousel.html' with categories=categories %}
  
  Optional parameters:
    - current_category_slug: slug of currently active category (for highlighting)
    - title: custom title (default: "دسته بندی محتوا")
    - show_title: boolean to show/hide title (default: true)
{% endcomment %}

{% if categories %}
<!-- 3D Category Carousel -->
<div id="categoryCarousel" class="category-carousel" role="region" aria-label="Category navigation carousel">
  <div aria-live="polite" class="sr-only category-carousel-live"></div>
  
  <div class="category-carousel-container">
    {% for category in categories %}
    <a
      href="{% url 'category_posts' category.slug %}"
      class="category-carousel-card {% if current_category_slug and category.slug == current_category_slug %}active-category{% endif %}"
      data-category-slug="{{ category.slug }}"
      style="--cat-bg: {{ category|category_bg }}; --cat-accent: {{ category|category_accent }};"
      title="{{ category.name }}"
      aria-label="Browse {{ category.name }} category ({{ category.post_count }} posts){% if current_category_slug and category.slug == current_category_slug %} - Current category{% endif %}"
    >
      <div class="category-carousel-card-icon">
        <i class="{{ category|category_icon }}" aria-hidden="true"></i>
      </div>
      <div class="category-carousel-card-name">{{ category.name }}</div>
      <div class="category-carousel-card-count">({{ category.post_count }} پست)</div>
    </a>
    {% endfor %}
  </div>
  
  <!-- Navigation Buttons -->
  <button type="button" class="category-carousel-nav prev" aria-label="Previous category">
    ‹
  </button>
  <button type="button" class="category-carousel-nav next" aria-label="Next category">
    ›
  </button>
</div>

<!-- Fallback for no-JS -->
<noscript>
  <div class="category-carousel-fallback">
    {% for category in categories %}
    <a
      href="{% url 'category_posts' category.slug %}"
      class="category-card-fallback {% if current_category_slug and category.slug == current_category_slug %}active{% endif %}"
      title="{{ category.name }}"
    >
      <i class="{{ category|category_icon }}" aria-hidden="true"></i>
      <span>{{ category.name }}</span>
    </a>
    {% endfor %}
  </div>
</noscript>
{% else %}
<p class="text-muted text-center">هنوز دسته‌بندی‌ای در دسترس نیست.</p>
{% endif %}

