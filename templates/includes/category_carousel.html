{% load static %}
{% load category_extras %}
{% comment %}
  Reusable 3D Category Carousel Partial
  
  Usage:
    {% include 'includes/category_carousel.html' with categories=categories %}
  
  Optional parameters:
    - current_category_slug: slug of currently active category (for highlighting)
    - title: custom title (default: "دسته بندی محتوا")
    - show_title: boolean to show/hide title (default: true)
{% endcomment %}

{% if categories %}
<!-- 3D Category Carousel -->
<div id="categoryCarousel" class="category-carousel" role="region" aria-label="Category navigation carousel">
  <div aria-live="polite" class="sr-only category-carousel-live"></div>
  
  <div class="category-carousel-container">
    {% for category in categories %}
    <a
      href="{% url 'category_posts' category.slug %}"
      class="category-carousel-card {% if current_category_slug and category.slug == current_category_slug %}active-category{% endif %}"
      data-category-slug="{{ category.slug }}"
      data-color-index="{{ category|category_color_index }}"
      title="{{ category.name }}"
      aria-label="Browse {{ category.name }} category ({{ category.post_count }} posts){% if current_category_slug and category.slug == current_category_slug %} - Current category{% endif %}"
    >
      <div class="category-carousel-card-icon">
        {% if category.slug == "careers-economy" %}
          <i class="bi bi-cash-coin"></i>
        {% elif category.slug == "law-integration" %}
          <i class="bi bi-globe"></i>
        {% elif category.slug == "life-in-sweden" %}
          <i class="bi bi-briefcase"></i>
        {% elif category.slug == "skills-learning" %}
          <i class="bi bi-bank"></i>
        {% elif category.slug == "platform-updates" %}
          <i class="bi bi-newspaper"></i>
        {% elif category.slug == "events-announcements" %}
          <i class="bi bi-calendar-event"></i>
        {% elif category.slug == "photo-gallery" %}
          <i class="bi bi-camera"></i>
        {% elif category.slug == "public-services" %}
          <i class="bi bi-cart"></i>
        {% elif category.slug == "stories-experiences" %}
          <i class="bi bi-heart-pulse"></i>
        {% elif category.slug == "community-engagement" %}
          <i class="bi bi-translate"></i>
        {% elif category.slug == "personalities" %}
          <i class="bi bi-person-star"></i>
        {% else %}
          <i class="bi bi-tag"></i>
        {% endif %}
      </div>
      <div class="category-carousel-card-name">{{ category.name }}</div>
      <div class="category-carousel-card-count">({{ category.post_count }} پست)</div>
    </a>
    {% endfor %}
  </div>
  
  <!-- Navigation Buttons -->
  <button type="button" class="category-carousel-nav prev" aria-label="Previous category">
    ‹
  </button>
  <button type="button" class="category-carousel-nav next" aria-label="Next category">
    ›
  </button>
</div>

<!-- Fallback for no-JS -->
<noscript>
  <div class="category-carousel-fallback">
    {% for category in categories %}
    <a
      href="{% url 'category_posts' category.slug %}"
      class="category-card-fallback {% if current_category_slug and category.slug == current_category_slug %}active{% endif %}"
      title="{{ category.name }}"
    >
      <i class="bi bi-{% if category.slug == 'careers-economy' %}cash-coin{% elif category.slug == 'law-integration' %}globe{% elif category.slug == 'life-in-sweden' %}briefcase{% elif category.slug == 'skills-learning' %}bank{% elif category.slug == 'platform-updates' %}newspaper{% elif category.slug == 'events-announcements' %}calendar-event{% elif category.slug == 'photo-gallery' %}camera{% elif category.slug == 'public-services' %}cart{% elif category.slug == 'stories-experiences' %}heart-pulse{% elif category.slug == 'community-engagement' %}translate{% elif category.slug == 'personalities' %}person-star{% else %}tag{% endif %}"></i>
      <span>{{ category.name }}</span>
    </a>
    {% endfor %}
  </div>
</noscript>
{% else %}
<p class="text-muted text-center">هنوز دسته‌بندی‌ای در دسترس نیست.</p>
{% endif %}

